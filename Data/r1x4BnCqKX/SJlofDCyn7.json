{"title": "good paper, nice contribution", "review": "The paper presents a novel end-to-end mechanistic generative model of electron flow in a particular type of chemical reaction (\u201cLinear Electron Flow\u201d reactions) . Interestingly, modeling the flow of electrons aids in the prediction of the final product of a chemical reaction over and above problems which attack this \u201cproduct prediction problem\u201d directly. The method is also shown to generalize well to held-out reactions (e.g. from a chemistry textbook).\n\nGeneral Impressions\n\n+ For me the biggest selling point is that it improves performance in predicting the ultimate reaction outcome. It should do because it provides strictly more supervision, but it\u2019s great that it actually does. \n+ Because it models the reaction mechanism the model is interpretable, and it\u2019s possible to enforce constraints, e.g. that dynamics are physically possible.\n+ Generalises outside of the dataset to textbook problems :-)\n+ Well-founded modeling choices and neural network architectures.\n- Only applies to a very particular type of reaction (heterolytic LEF). \n- Requires supervision on the level of electron paths. This seems to inhibit applying the model to more datasets or extending it to other types of reactions.\n- Furthermore the supervision extraction does not seem take advantage of symmetries noted in the section(s) about difficulty evaluating inference. \n- It would be nice to margin out the electron flow model and just maximize the marginal likelihood for the product prediction problem.\n\nNovelty\nI\u2019m not an expert on the literature of applying machine learning to the problems of reaction {product, mechanism} prediction but the paper appears to conduct a thorough review of the relevant methods and occupy new territory in terms of the modeling strategy while improving over SOTA performance.\n\nClarity\nThe writing/exposition is in general extremely clear. Nicely done. There are some suggestions/questions which I think if addressed would improve clarity.\n\nWays to improve the paper\n1. Better motivate the use of machine learning on this problem. What are the limitations of the arrow-pushing models? \n\n2. Explain more about the Linear Electron Flow reactions, especially:\n- Why does the work only consider \u201cheterolytic\u201d LEF reactions, what other types of LEF reactions are omitted?\n- Is the main blocker to extending the model on the modeling front or the difficulties of extracting ground-truth targets? It appears to be the latter but this could be made more clear. Also that seems to be a pretty severe limitation to making the algorithm more general. Could you comment on this?\n\nQuestions\n1. Is splitting up the electron movement model into bond \u201cremoval\u201d and \u201caddition\u201d steps just a matter of parameterization or is that physically how the movements work? \n\n2. It appears that Jin et al reports Top 6/8/10 whereas this work reports Top 1/3/5 accuracy on the USPTO dataset. It would be nice if there was overlap :-). Do your Top 6/8/10 results with the WLDN model agree with the Jin et al paper?\n\n\nNits\nSection 2.3, first paragraph \u201c...(LEF) topology is by far the most important\u201d: Could you briefly say why? It\u2019s already noted that they\u2019re the most common in the database. Why?\n\nSection 3.ElectionMovement, first paragraph. \u201cObserver that since LEF reactions are a single path of electrons\u2026\u201d. Actually, it\u2019s not super clear what this means from the brief description of LEF. Can you explain these reactions in slightly more detail?\n\nSection 3.ElectionMovement, second paragraph. \u201cDifferently, the above distribution can be split\u2026\u201d. Awkward phrasing. How about \u201cIn contrast, the above distribution can be split\u2026\u201d. \n\nSection 3.Training, last sentence \u201c...minibatches of size one reaction\u201d. Slightly awkward phrasing. Maybe \u201c...minibatches consisting of a single reaction\u201d?\n\nSection 5.2, second sentence. \u201cHowever, underestimates the model\u2019s actual predictive accuracy\u2026\u201d. It looks like a word accidentally got deleted here or something.\n\nSection 5.2, paragraph 4. \u201cTo evaluate if our model predicts the same major project\u201d... Did you mean \u201cthe same major product\u201d?\n\n", "rating": "8: Top 50% of accepted papers, clear accept", "confidence": "4: The reviewer is confident but not absolutely certain that the evaluation is correct"}